<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG to Canvas</title>
</head>
<body>
    <div>
        <canvas id="myCanvas"></canvas>
        <input type="hidden" id="h" value="0"></input>
        <canvas id="animation"></canvas>
    </div>
<script>
        const canvas = document.getElementById("myCanvas");
        const ctx = canvas.getContext("2d");
        const minWidth = 300
        const minHeight = 300

        async function fetchApi() {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/todos/1')
                const data = await response.json()
                console.log(data)
                return data 
            }
            catch {
                console.error('Error fetching data: ', error)
            }
        }

        function createGradient(context, gradientId) {
            const gradient = context.createLinearGradient(0, 0, canvas.width, canvas.height);

            if (gradientId === "#Gradient-0") {
                gradient.addColorStop(0, "#196df3");
                gradient.addColorStop(1, "#25273d");
            } else if (gradientId === "#Gradient-1") {
                gradient.addColorStop(0, "#594de7");
                gradient.addColorStop(1, "#7b61ff");
            } else if (gradientId === "#Gradient-2") {
                gradient.addColorStop(0, "#1a6cf2");
                gradient.addColorStop(1, "#000");
            } else if (gradientId === "#Gradient-3") {
                gradient.addColorStop(0, "#ffffff");
                gradient.addColorStop(1, "#000000");
            } else if(gradientId === "#Gradient-4") {
                gradient.addColorStop(0.2, "#23263c")
                gradient.addColorStop(1, "#196df3")
            }
            return gradient;
        }


        function draw( apiData, percentData) {
            const width = Math.max(window.innerWidth, minWidth);
            const height = Math.max(window.innerHeight, minHeight);

            canvas.width = width;
            canvas.height = height;

            
            const scale = Math.min(width / 192, height / 192);
            ctx.scale(scale, scale);

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 96, 96, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-0");
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 96, 96, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-1");
            ctx.globalAlpha = 0.8;
            ctx.fill();
            ctx.globalAlpha = 1;
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();    
            ctx.ellipse(96, 96, 76, 76, 0, 0, 2 * Math.PI);
            ctx.fillStyle = "#0f2439";
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 96, 96, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-0");
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 96, 96, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-1");
            ctx.globalAlpha = 0.8;
            ctx.fill();
            ctx.globalAlpha = 1;
            ctx.closePath();
            ctx.restore();
            
            ctx.save();
            ctx.beginPath();    
            ctx.ellipse(96, 96, 76, 76, 0, 0, 2 * Math.PI);
            ctx.fillStyle = "#0f2439";
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();    
            ctx.ellipse(96, 96, 79, 79, 0, 0, 2 * Math.PI);
            ctx.fillStyle = "#22263a";
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 79, 79, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-2");
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 96, 96, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-3");
            ctx.globalAlpha = 0.8;
            ctx.fill();
            ctx.globalAlpha = 1;
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 76, 76, 0, 0, 2 * Math.PI);
            ctx.fillStyle = "#0f2439";
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 79, 79, 0, 0, 2 * Math.PI);
            ctx.fillStyle = "#22263a"
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.ellipse(96, 96, 79, 79, 0, 0, 2 * Math.PI);
            ctx.fillStyle = createGradient(ctx, "#Gradient-2");
            ctx.fill();
            ctx.closePath();
            ctx.restore();

            ctx.save();
            ctx.fillStyle = "#ffffff";
            ctx.font = "40px Roboto, Arial, sans-serif";
            ctx.textAlign = "start";
            ctx.textBaseline = "middle";
            ctx.fillText(apiData, 65, 96);
            ctx.restore();

            ctx.save();
            ctx.fillStyle = "#ffffff";
            ctx.font = "20px Roboto, Arial, sans-serif";
            ctx.textAlign = "start";
            ctx.textBaseline = "middle";
            ctx.fillText(percentData, 115, 100);
            ctx.restore();
        }

        function circ() {
            var canvas = document.getElementById('animation')
            var ctx = canvas.getContext('2d')
            var i = parseFloat(document.getElementById('h').value) + 10;

            ctx.beginPath();
            ctx.moveTo(200, 0); 
            ctx.lineTo(200 + 40 * Math.sin(i * Math.PI / 180), 135);
            ctx.lineWidth = 5;
            ctx.strokeStyle = "grey";
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(200 + 40 * Math.sin(i * Math.PI / 180), 150, 20, 0, 2 * Math.PI, false);
            if (i == 360 || i > 360) { i = 0; }

            document.getElementById('h').value = i;
            
            var x = 200;
            var y = 150;
            var grd = ctx.createRadialGradient(x,y,2,x,y,18)

            grd.addColorStop(0, '#8ED6FF');

            grd.addColorStop(1, '#0000ff');

            ctx.fillStyle = grd;

            ctx.fill();
        }

        function animateDraw() {
            circ()
            setTimeout(function() {
                requestAnimationFrame(animateDraw)
            }, 1600)
        }

        fetchApi().then((res) => {
            const apiData = res.userId.toString() + '5'
            const percentData = '%'
            draw(apiData, percentData)
            animateDraw()
            
            window.addEventListener('resize', () => {
                draw(apiData, percentData)
                animateDraw()
            })
        })
    </script>
</body>
</html>
